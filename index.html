<!doctype html>
<html>
<head>
	<link rel="stylesheet" href="stylesheets/main.css" type="text/css" />
	<script src='http://api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.js'></script>
	<link href='http://api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.css' rel='stylesheet' />
  <!--[if lte IE 8]>
    <link href='http://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.ie.css' rel='stylesheet' >
    <![endif]-->
    <style>
    #map { margin-right: auto; margin-left: auto; top:0; bottom:0; height: 500px}
    </style>
    <title>PNW Streams and Rivers</title>
</head>

<body>
	<div id="wrapper">
		<div class='navigation'>
			<ul>
				<li class="left"><a href="about">about</a></li>
				<li class="center"><a href="projects">projects</a></li>
				<li class="right"><a href="resume">resume</a></li>
			</ul>
		</div>
		<div class="page-text" style="text-align: center;">
			<h1 style="text-align:center; font-size:200%">Mapping Streams in the Pacific Northwest</h1>
			<h4 style="text-align:center">7/21/2014</h4>
			<p style="a:hover{text-decoration:underline;}">I like visualizing river networks because they often times explain why the topography in any given area looks the way it does. The <a href="http://nhd.usgs.gov/" target='_blank'>National Hydrography Dataset</a> is a geo database of all the catalogued streams in the US and includes lots of stream attributes such as stream name and estimated annual flow. This second attribute is cool because I can use it to change the symbology of the river so larger streams get darker line colors and wider line widths, while smaller streams get lighter line colors and narrower line widths. Using flow directly is difficult when mapping the whole Columbia River Basin since the Columbia River has such large flow volumes relative to the other streams (~265,000 cfs at the mouth). Basically, the histogram of flows throughout the region is heavily right skewed to the point where good symbology is near impossible. To make the data usable I took the fifth root of flows. While the results are still not normal, they are MUCH better, and as you can see on the map, streams like the Willamette, Deschutes and Snake pop out when they should.</p>

			<div id='map'></div>
			<p style="a:hover{text-decoration:underline;}">Once I finished the symbology, I moved on to creating the map. I wanted to show the streams on top of the terrain but I didn't want to create my own base-layer. Instead, I used TileMill to symbolize my streams with no baselayer, exported them to MBTiles which I could then upload to Mapbox and display on top of their terrain basemap with roads and labels turned off. <a href="https://www.mapbox.com/foundations/an-open-platform/#mbtiles" target='_blank'>MBTiles</a> are a lot cooler than I originally realized because they can store mouse-over data and other information inside the tiles. It was therefore very easy to include stream name and estimated annual flows as a popup for each stream. I limited the zoom extents of the map to a range of six to ten since the size of the MBTiles grows exponentially for each additional zoom level. At this zoom range and spatial extent the MBTiles already took up 96 Mb! 
			</p>
			<p>So there you have it. All the major streams in the Pacific Northwest! Some of the stream names are blank. That's because they are unnamed. I'm going to have fun poking around the region looking at streams that are named. It seems like you could make a fun little trivia quiz out of this. Whatever you end up using this for, I hope you enjoy it. I'm going to be thinking about how I can add some more data to the map and make it more interactive. Feel free to email me with any cool ideas.
			</p>
			<script type='text/javascript'>
			var map = L.mapbox.map('map', 'mpsaris01.j1376g9i', {
				minZoom: 6,
				maxZoom: 10}).setView([45.359, -118],6);
			</script>
		</div>
		<div class="footer">
			<a href="/">home</a>
		</div>
	</div>
</body>
</html>